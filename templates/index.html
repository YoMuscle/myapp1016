{% extends 'base.html' %}
{% block title %}部落格文章列表{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>部落格文章列表</h2>
    <a href="{{ url_for('new_post') }}" class="btn btn-success">新增文章</a>
</div>
<table class="table table-striped table-bordered">
    <thead class="table-primary">
        <tr>
            <th>標題</th>
            <th>作者</th>
            <th>操作</th>
        </tr>
    </thead>
    <tbody>
        {% for post in posts %}
        <tr>
            <td><a href="{{ url_for('post_detail', post_id=post.id) }}">{{ post.title }}</a></td>
            <td>{{ post.author }}</td>
            <td>
                <a href="{{ url_for('edit_post', post_id=post.id) }}" class="btn btn-sm btn-warning">編輯</a>
                <button class="btn btn-sm btn-danger" onclick="deletePost('{{ post.id }}')">刪除</button>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<script>
function deletePost(postId) {
    if (confirm('確定要刪除這篇文章嗎？')) {
        fetch(`/api/posts/${postId}`, {method: 'DELETE'})
            .then(res => {
                if (res.ok) {
                    window.location.reload();
                } else {
                    alert('刪除失敗');
                }
            });
    }
}
</script>
{% endblock %}
